{namespace n=GeorgRinger\News\ViewHelpers}
{namespace i=Medienreaktor\NewsInstantArticles\ViewHelpers}
<f:section name="Content">
    <!doctype html>
    <html lang="{settings.instantarticles.language}" prefix="op: http://media.facebook.com/op#">
        <head>
            <meta charset="utf-8">
            <link rel="canonical" href="{n:link(newsItem: newsItem, settings: settings, uriOnly: 1)}">
            <title><n:format.hsc>{newsItem.title}</n:format.hsc></title>
            <meta property="fb:article_style" content="{settings.instantarticles.articleStyle}">
        </head>
        <body>
            <article>
                <f:render section="Header" arguments="{settings: settings, newsItem: newsItem}" />
                <f:render section="Body" arguments="{settings: settings, newsItem: newsItem}" />
                <f:render section="Footer" arguments="{settings: settings, newsItem: newsItem}" />
            </article>
        </body>
    </html>
</f:section>

<f:section name="Header">
    <header>
        <f:if condition="{newsItem.falMedia}">
            <f:render section="Media" arguments="{media: newsItem.falMedia}" />
        </f:if>
        <h1>{newsItem.title}</h1>
        <f:if condition="{newsItem.teaser}"><h2>{newsItem.teaser}</h2></f:if>
        <f:if condition="{newsItem.author}"><address>{newsItem.author}</address></f:if>
    </header>
</f:section>

<f:section name="Media">
    <f:if condition="{media -> f:count()} == 1">
        <f:then>
            <f:render section="MediaElement" arguments="{mediaElement: media.0}" />
        </f:then>
        <f:else>
            <figure class="op-slideshow">
                <f:for each="{media}" as="mediaElement">
                    <f:render section="MediaElement" arguments="{mediaElement: mediaElement}" />
                </f:for>
            </figure>
        </f:else>
    </f:if>
</f:section>

<f:section name="MediaElement">
    <f:if condition="{mediaElement.originalResource.type} == 2">
		<f:render section="MediaElementImage" arguments="{mediaElement: mediaElement}" />
	</f:if>
    <f:if condition="{mediaElement.originalResource.type} == 5">
		<f:render section="MediaElementImage" arguments="{mediaElement: mediaElement}" />
	</f:if>
	<f:if condition="{mediaElement.originalResource.type} == 4">
		<f:render section="MediaElementVideo" arguments="{mediaElement: mediaElement}" />
	</f:if>
</f:section>

<f:section name="MediaElementCaption">
    <f:if condition="{mediaElement.title}">
        <figcaption class="op-vertical-bottom">
            <f:if condition="{mediaElement.title}">
                <h1 class="op-vertical-bottom">{mediaElement.title}</h1>
            </f:if>
            {mediaElement.description}
        </figcaption>
    </f:if>
</f:section>

<f:section name="MediaElementImage">
    <figure data-feedback="fb:likes,fb:comments">
        <f:image src="{mediaElement.uid}" treatIdAsReference="1" minWidth="1024" minHeight="1024" maxWidth="2048" maxHeight="2048" />
        <f:render section="MediaElementCaption" arguments="{mediaElement: mediaElement}" />
    </figure>
</f:section>

<f:section name="MediaElementVideo">
    <f:if condition="{mediaElement.originalResource.mimeType} == 'video/mp4'">
        <figure data-feedback="fb:likes,fb:comments">
            <video>
                <source src="{f:uri.image(src: mediaElement.uid, treatIdAsReference: 1)}" type="video/mp4" />
            </video>
            <f:render section="MediaElementCaption" arguments="{mediaElement: mediaElement}" />
        </figure>
    </f:if>
</f:section>

<f:section name="Body">
    <i:contentTransform>
        <f:format.html>{newsItem.bodytext}</f:format.html>
        <f:if condition="{newsItem.contentElements}">
    		<f:cObject typoscriptObjectPath="lib.tx_news.contentElementRendering">{newsItem.contentElementIdList}</f:cObject>
    	</f:if>
    </i:contentTransform>
</f:section>

<f:section name="Footer">
    <footer>
        <f:if condition="{newsItem.related}">
            <ul class="op-related-articles">
                <f:for each="{newsItem.related}" as="related">
                    <li><a href="{n:link(newsItem: related, settings: settings, uriOnly: 1)}"></a></li>
                </f:for>
            </ul>
        </f:if>
        <f:if condition="{settings.list.rss.channel.description}">
            <aside>{settings.list.rss.channel.description}</aside>
        </f:if>
        <f:if condition="{settings.list.rss.channel.copyright}">
			<small>{settings.list.rss.channel.copyright}</small>
		</f:if>
    </footer>
</f:section>
